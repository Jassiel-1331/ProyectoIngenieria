# ARQUITECTURA DEL PROYECTO - CineClip API

## ğŸ“ Diagrama General

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CLIENTE (Frontend)                      â”‚
â”‚              (React, Vue, Angular, etc.)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                 (HTTP/REST API)
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ROUTER (routes/api.php)                â”‚
â”‚  - POST   /api/register                                     â”‚
â”‚  - POST   /api/login                                        â”‚
â”‚  - POST   /api/logout                                       â”‚
â”‚  - GET    /api/movies                                       â”‚
â”‚  - GET    /api/movies/{id}                                  â”‚
â”‚  - POST   /api/movies (admin)                               â”‚
â”‚  - PATCH  /api/movies/{id} (admin)                          â”‚
â”‚  - DELETE /api/movies/{id} (admin)                          â”‚
â”‚  - GET    /api/generos                                      â”‚
â”‚  - POST   /api/preferencias (auth)                          â”‚
â”‚  - POST   /api/calificaciones (auth)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                â”‚                â”‚
        â–¼                â–¼                â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚Middlewareâ”‚   â”‚Controllersâ”‚   â”‚  Services   â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚AuthUser â”‚    â”‚UsuarioCtrlâ”‚   â”‚AuthService  â”‚
   â”‚AdminMdw â”‚    â”‚MovieCtrl  â”‚   â”‚RegisterServ â”‚
   â”‚         â”‚    â”‚CalifCtrl  â”‚   â”‚CacheMovieS  â”‚
   â”‚         â”‚    â”‚GeneroCtrl â”‚   â”‚             â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
        â”‚                â”‚                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                â”‚                    â”‚
        â–¼                â–¼                    â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   Models    â”‚  â”‚ Controllers â”‚  â”‚   Validation â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚             â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ Usuario     â”‚  â”‚ (Request    â”‚  â”‚ Email unique â”‚
   â”‚ Cache_tmdb  â”‚  â”‚  validation)â”‚  â”‚ Min/Max      â”‚
   â”‚ Calificaciones          â”‚  â”‚ Range check  â”‚
   â”‚ Genero      â”‚  â”‚ Form reqs)  â”‚  â”‚ Type check   â”‚
   â”‚ PreferenciaUâ”‚  â”‚             â”‚  â”‚              â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚    BASE DE DATOS (sqLite)    â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ usuarios                     â”‚
   â”‚ cache_tmdb                   â”‚
   â”‚ calificaciones               â”‚
   â”‚ generos                      â”‚
   â”‚ preferencias_usuario         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ Estructura de Carpetas

```
cineclip_back/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ Http/
â”‚   â”‚   â”œâ”€â”€ Controllers/
â”‚   â”‚   â”‚   â”œâ”€â”€ UsuarioController.php        (AutenticaciÃ³n)
â”‚   â”‚   â”‚   â”œâ”€â”€ MovieController.php          (CRUD pelÃ­culas)
â”‚   â”‚   â”‚   â”œâ”€â”€ CalificacionesController.php (Calificaciones)
â”‚   â”‚   â”‚   â””â”€â”€ GeneroController.php         (GÃ©neros/Preferencias)
â”‚   â”‚   â”œâ”€â”€ Middleware/
â”‚   â”‚   â”‚   â”œâ”€â”€ AuthUser.php                 (Verifica login)
â”‚   â”‚   â”‚   â””â”€â”€ AdminMiddleware.php          (Verifica admin)
â”‚   â”‚   â””â”€â”€ Requests/
â”‚   â”‚       (Validaciones de formularios)
â”‚   â”œâ”€â”€ Models/
â”‚   â”‚   â”œâ”€â”€ Usuario.php                      (Usuario con relaciones)
â”‚   â”‚   â”œâ”€â”€ Cache_tmdb.php                   (PelÃ­culas en cachÃ©)
â”‚   â”‚   â”œâ”€â”€ Calificaciones.php               (Valoraciones)
â”‚   â”‚   â”œâ”€â”€ Genero.php                       (GÃ©neros)
â”‚   â”‚   â””â”€â”€ PreferenciaUsuario.php           (Preferencias)
â”‚   â”œâ”€â”€ Services/
â”‚   â”‚   â”œâ”€â”€ AuthService.php                  (LÃ³gica de login)
â”‚   â”‚   â”œâ”€â”€ RegisterService.php              (LÃ³gica de registro)
â”‚   â”‚   â””â”€â”€ CacheMovieService.php            (LÃ³gica de cachÃ©)
â”‚   â””â”€â”€ Providers/
â”‚       â””â”€â”€ AppServiceProvider.php
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ api.php                              (Rutas API)
â”‚   â”œâ”€â”€ web.php                              (Rutas web)
â”‚   â””â”€â”€ console.php                          (Comandos)
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â”œâ”€â”€ *_create_usuarios_table.php
â”‚   â”‚   â”œâ”€â”€ *_create_cache_tmdb_table.php
â”‚   â”‚   â”œâ”€â”€ *_create_calificaciones_table.php
â”‚   â”‚   â””â”€â”€ *_create_generos_and_preferencias_table.php
â”‚   â”œâ”€â”€ seeders/
â”‚   â”‚   â””â”€â”€ DatabaseSeeder.php               (Datos iniciales)
â”‚   â””â”€â”€ factories/
â”‚       â””â”€â”€ UserFactory.php
â”œâ”€â”€ bootstrap/
â”‚   â”œâ”€â”€ app.php                              (ConfiguraciÃ³n app)
â”‚   â””â”€â”€ cache/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ app.php                              (Config general)
â”‚   â”œâ”€â”€ auth.php                             (Config auth)
â”‚   â”œâ”€â”€ database.php                         (Config BD)
â”‚   â””â”€â”€ ...
â”œâ”€â”€ storage/
â”‚   â”œâ”€â”€ logs/                                (Logs)
â”‚   â””â”€â”€ ...
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ Unit/                                (Tests unitarios)
â”‚   â””â”€â”€ Feature/                             (Tests integraciÃ³n)
â”œâ”€â”€ public/
â”‚   â””â”€â”€ index.php                            (Entry point)
â”œâ”€â”€ .env                                     (Variables de entorno)
â”œâ”€â”€ .env.example
â”œâ”€â”€ composer.json                            (Dependencias)
â”œâ”€â”€ artisan                                  (CLI tool)
â”œâ”€â”€ API_DOCUMENTATION.md                     (Docs API)
â”œâ”€â”€ RESUMEN_IMPLEMENTACION.md                (Resumen)
â””â”€â”€ TESTING_CHECKLIST.md                     (Checklist pruebas)
```

---

## ğŸ”„ Flujo de AutenticaciÃ³n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Usuario nuevo  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ REGISTRO â”‚
    â”‚ (POST)   â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UsuarioController::register  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Validar datos                â”‚
â”‚ - Email vÃ¡lido               â”‚
â”‚ - Email Ãºnico                â”‚
â”‚ - Password mÃ­n 6 caracteres  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RegisterService::register    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Usuario::create              â”‚
â”‚ - Hash password              â”‚
â”‚ - Guardar en BD              â”‚
â”‚ - Retornar usuario           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Response 201 (Created)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Usuario existe â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  LOGIN   â”‚
    â”‚ (POST)   â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UsuarioController::login     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Validar datos                â”‚
â”‚ - Email requerido            â”‚
â”‚ - Password requerido         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AuthService::login           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Buscar usuario por email     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚          â”‚
   NO        SÃ
   â”‚          â”‚
   â–¼          â–¼
 401      Verificar password
   â”‚          â”‚
   â”‚      â”Œâ”€â”€â”€â”´â”€â”€â”
   â”‚      â”‚      â”‚
   â”‚     NO    SÃ
   â”‚      â”‚      â”‚
   â”‚      â–¼      â–¼
   â”‚     401   Crear sesiÃ³n
   â”‚           â”‚
   â”‚           â–¼
   â”‚       session(['user_id' => $id])
   â”‚           â”‚
   â”‚           â–¼
   â””â”€â”€â”€â”€â”€â”€â”€â”€  200 OK
```

---

## ğŸ¬ Flujo de PelÃ­culas (Admin)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Admin login â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Crear pelÃ­cula
â”‚    (POST)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MovieController      â”‚
â”‚ ::store              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Validaciones                 â”‚
â”‚ - Auth middleware (LOGIN)    â”‚
â”‚ - Admin middleware (ADMIN)   â”‚
â”‚ - Datos vÃ¡lidos              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CacheMovieService::cachear   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Verificar si existe en cachÃ© â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
    â”Œâ”€â”€â”´â”€â”€â”
    â”‚     â”‚
  NO    SÃ
    â”‚     â”‚
    â–¼     â–¼
 CREATE  UPDATE
    â”‚     â”‚
    â””â”€â”€â”¬â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cache_tmdb::create/update    â”‚
â”‚ - Guardar JSON de TMDB       â”‚
â”‚ - Estado: activo             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Response 201/200             â”‚
â”‚ - PelÃ­cula guardada          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Admin eliminaâ”‚
â”‚  pelÃ­cula    â”‚
â”‚   (DELETE)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MovieController::destroy     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CacheMovieService            â”‚
â”‚ ::desactivarPelicula         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cache_tmdb::update           â”‚
â”‚ - estado = 'inactivo'        â”‚
â”‚ - NO elimina datos           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Response 200                 â”‚
â”‚ - PelÃ­cula desactivada       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¾ Diagrama Relacional Base de Datos

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       USUARIOS          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id_usuario (PK)         â”‚
â”‚ nombre                  â”‚
â”‚ correo (UNIQUE)         â”‚
â”‚ contrasena_hash         â”‚
â”‚ rol (usuario/admin)     â”‚
â”‚ fecha_registro          â”‚
â”‚ timestamps              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚             â”‚
    â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚CALIFICACIONESâ”‚  â”‚PREFERENCIAS_USUARIO â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id_cal (PK) â”‚  â”‚ id_pref (PK)        â”‚
â”‚ id_usuario  â”‚â—„â”€â”¤ id_usuario (FK)     â”‚
â”‚ id_tmdb     â”‚  â”‚ id_genero (FK)      â”‚
â”‚ calificacionâ”‚  â”‚ fecha_preferencia   â”‚
â”‚ comentario  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ fecha_cal   â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â”‚ id_tmdb (FK)
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CACHE_TMDB        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id_tmdb (PK)        â”‚
â”‚ tipo                â”‚
â”‚ json_data           â”‚
â”‚ estado (activo...)  â”‚
â”‚ override_titulo     â”‚
â”‚ override_sinopsis   â”‚
â”‚ override_image      â”‚
â”‚ fecha_cache         â”‚
â”‚ timestamps          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     GENEROS         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id_genero (PK)      â”‚
â”‚ nombre (UNIQUE)     â”‚
â”‚ timestamps          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ id_genero (FK)
         â”‚
         â–¼
    (PREFERENCIAS)
```

### Relaciones
- **Usuario â†’ Calificaciones** (1:N) - Un usuario puede tener muchas calificaciones
- **Usuario â†’ Preferencias** (1:N) - Un usuario puede tener muchas preferencias
- **Cache_tmdb â†’ Calificaciones** (1:N) - Una pelÃ­cula puede tener muchas calificaciones
- **Genero â†’ Preferencias** (1:N) - Un gÃ©nero puede ser preferencia de muchos usuarios
- **Usuario â†” Genero** (N:N through Preferencias) - Muchos usuarios a muchos gÃ©neros

---

## ğŸ” Flujo de Seguridad

```
REQUEST
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Â¿Requiere autenticaciÃ³n?     â”‚
â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”˜
   â”‚ SÃ                       â”‚ NO
   â–¼                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚ AuthUser Middleware  â”‚      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚ Â¿session('user_id')?  â”‚     â”‚
â””â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”    â”‚
 â”‚ NO: 401             SÃ: continÃºa
 â”‚                        â”‚
 â–¼                        â–¼
401 Unauthorized    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Â¿Requiere admin?     â”‚
                    â””â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”˜
                     â”‚ SÃ                 â”‚ NO
                     â–¼                    â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                â”‚ AdminMiddleware      â”‚ â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
                â”‚ Â¿Usuario es admin?   â”‚ â”‚
                â””â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”˜ â”‚
                 â”‚ NO: 403            â”‚SÃ
                 â”‚                    â”‚
                 â–¼                    â–¼
            403 Forbidden      Continuar
                              â”‚
                              â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  VALIDAR     â”‚
                        â”‚   DATOS      â”‚
                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                        â”‚ - Email      â”‚
                        â”‚ - Rango      â”‚
                        â”‚ - Ãšnico      â”‚
                        â””â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                      â”Œâ”€â”€â”´â”€â”€â”
                      â”‚     â”‚
                     NO    SÃ
                      â”‚     â”‚
                      â–¼     â–¼
                    422   PROCESAR
                         â”‚
                         â–¼
                    RESPUESTA 200/201/etc.
```

---

## ğŸ“š Stack TecnolÃ³gico

```
Frontend
â”œâ”€â”€ React/Vue/Angular
â”œâ”€â”€ Axios/Fetch
â””â”€â”€ LocalStorage (para sesiones)

API
â”œâ”€â”€ PHP 8.1+
â”œâ”€â”€ Laravel 11
â”œâ”€â”€ RESTful API
â””â”€â”€ JSON Responses

Backend
â”œâ”€â”€ Controllers (LÃ³gica de endpoints)
â”œâ”€â”€ Services (LÃ³gica de negocio)
â”œâ”€â”€ Models (Orm Eloquent)
â”œâ”€â”€ Middleware (Seguridad)
â””â”€â”€ Migrations (Estructura BD)

Base de Datos
â”œâ”€â”€ MySQL 8.0+
â”œâ”€â”€ 5 Tablas relacionadas
â”œâ”€â”€ Foreign Keys
â””â”€â”€ Unique Constraints

Seguridad
â”œâ”€â”€ password_hash() - Hashing
â”œâ”€â”€ Sessions - AutenticaciÃ³n
â”œâ”€â”€ Middleware - AutorizaciÃ³n
â”œâ”€â”€ Validaciones - Input
â””â”€â”€ Relaciones - Integridad

Herramientas
â”œâ”€â”€ Composer - Package manager
â”œâ”€â”€ Artisan - CLI
â”œâ”€â”€ PHPUnit - Testing
â””â”€â”€ Git - Version control
```

---

## ğŸš€ Despliegue (Deployment)

```
Desarrollo
  â”‚
  â–¼
.env.example â†’ .env (local)
  â”‚
  â–¼
composer install
  â”‚
  â–¼
php artisan migrate
  â”‚
  â–¼
php artisan serve (localhost:8000)
  â”‚
  â–¼
Testing local


ProducciÃ³n
  â”‚
  â–¼
Git push â†’ Repositorio
  â”‚
  â–¼
CI/CD Pipeline (GitHub Actions, etc.)
  â”‚
  â–¼
â”œâ”€â”€ Run tests
â”œâ”€â”€ Build
â””â”€â”€ Deploy
  â”‚
  â–¼
Servidor (AWS, Azure, Digital Ocean, etc.)
  â”‚
  â–¼
â”œâ”€â”€ PHP 8.1+
â”œâ”€â”€ MySQL 8.0+
â”œâ”€â”€ Nginx/Apache
â””â”€â”€ SSL/HTTPS
  â”‚
  â–¼
.env (producciÃ³n)
  â”‚
  â–¼
php artisan migrate --env=production
  â”‚
  â–¼
AplicaciÃ³n en ProducciÃ³n
```

---

## ğŸ“Š Diagrama de Casos de Uso

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          SISTEMA CINECLIP               â”‚
â”‚   Plataforma de RecomendaciÃ³n de        â”‚
â”‚      PelÃ­culas/Series                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
        â”‚             â”‚
        â–¼             â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚USUARIO â”‚    â”‚ ADMIN  â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
       â”‚             â”‚
    â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”
    â”‚                   â”‚
    â–¼                   â–¼
 AUTENTICACIÃ“N      GESTIÃ“N DE
    â”‚               PELÃCULAS
    â”œâ”€ Registro      â”‚
    â”œâ”€ Login      â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”œâ”€ Logout     â”‚          â”‚
    â”‚         â”Œâ”€â”€â”€â”´â”€â”€â”    â”Œâ”€â”€â”´â”€â”€â”€â”
    â”‚         â–¼      â–¼    â–¼      â–¼
    â”‚       CREATE UPDATE DELETE
    â”‚                 EXPLORE
    â”‚                 â”‚
    â”‚            â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚            â”‚          â”‚
    â–¼            â–¼          â–¼
 PREFERENCIAS CALIFICACIONES RECOMENDACIONES
    â”‚            â”‚          â”‚
    â”œâ”€ Ver       â”œâ”€ Ver     â””â”€ Basadas en
    â”œâ”€ Agregar   â”œâ”€ Crear      gÃ©neros
    â””â”€ Eliminar  â”œâ”€ Actualizar â””â”€ Basadas en
                 â””â”€ Listar       historial
```

---

**Arquitectura completa y escalable lista para producciÃ³n** âœ…
